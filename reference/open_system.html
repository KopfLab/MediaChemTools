<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Open system calculations — open_system • microbialkitchen</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Open system calculations — open_system" />
<meta property="og:description" content="Functions to calculate pH and alkalinity in an open, carbonate-buffered system at equilibrium (i.e. with an unlimited CO2 reservoir) with an optional additional weak acid/base buffer. This is for simplified aqueous geochemical systems commonly encountered in culturing applications. All default constants are based on freshwater and there is no implicit salinity correction included (stability constants can be set manually). For more complex systems, please use a full aquatic chemistry suite instead." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106138361-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-106138361-4');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">microbialkitchen</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="in active development">0.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/quantities.html">Quantities</a>
</li>
<li>
  <a href="../articles/operations.html">Operations</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Carbonate Buffering
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/carbonate_chemistry_equations.html">Equations</a>
    </li>
    <li>
      <a href="../articles/carbonate_chemistry_examples.html">Examples</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kopflab/microbialkitchen">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Open system calculations</h1>
    <small class="dont-index">Source: <a href='https://github.com/kopflab/microbialkitchen/blob/master/R/carbonate_chem.R'><code>R/carbonate_chem.R</code></a></small>
    <div class="hidden name"><code>open_system.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Functions to calculate pH and alkalinity in an open, carbonate-buffered system at equilibrium (i.e. with an unlimited CO2 reservoir) with an optional additional weak acid/base buffer. This is for simplified aqueous geochemical systems commonly encountered in culturing applications. All default constants are based on freshwater and there is no implicit salinity correction included (stability constants can be set manually). For more complex systems, please use a full aquatic chemistry suite instead.</p>
    </div>

    <pre class="usage"><span class='fu'>calculate_open_system_pH</span><span class='op'>(</span>
  <span class='va'>pCO2</span>,
  `H2CO3*` <span class='op'>=</span> <span class='va'>solubility</span> <span class='op'>*</span> <span class='va'>pCO2</span>,
  solubility <span class='op'>=</span> <span class='fu'><a href='gas_calculations.html'>calculate_gas_solubility</a></span><span class='op'>(</span><span class='st'>"CO2"</span>, <span class='va'>temperature</span><span class='op'>)</span>,
  temperature <span class='op'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='st'>"C"</span><span class='op'>)</span>,
  pKa1 <span class='op'>=</span> <span class='fl'>6.3</span>,
  pKa2 <span class='op'>=</span> <span class='fl'>10.3</span>,
  pKw <span class='op'>=</span> <span class='fl'>14</span>,
  buffer <span class='op'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"M"</span><span class='op'>)</span>,
  <span class='va'>buffer_pKa</span>,
  alkalinity <span class='op'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"M"</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>calculate_open_system_alkalinity</span><span class='op'>(</span>
  <span class='va'>pH</span>,
  <span class='va'>pCO2</span>,
  `H2CO3*` <span class='op'>=</span> <span class='va'>solubility</span> <span class='op'>*</span> <span class='va'>pCO2</span>,
  solubility <span class='op'>=</span> <span class='fu'><a href='gas_calculations.html'>calculate_gas_solubility</a></span><span class='op'>(</span><span class='st'>"CO2"</span>, <span class='va'>temperature</span><span class='op'>)</span>,
  temperature <span class='op'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span><span class='op'>(</span><span class='fl'>25</span>, <span class='st'>"C"</span><span class='op'>)</span>,
  pKa1 <span class='op'>=</span> <span class='fl'>6.3</span>,
  pKa2 <span class='op'>=</span> <span class='fl'>10.3</span>,
  pKw <span class='op'>=</span> <span class='fl'>14</span>,
  buffer <span class='op'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='st'>"M"</span><span class='op'>)</span>,
  <span class='va'>buffer_pKa</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pCO2</th>
      <td><p>the partial pressure of CO2 (a pressure quantity)</p></td>
    </tr>
    <tr>
      <th>H2CO3*</th>
      <td><p>the concentration of H2CO3* (a molarity quantity), by default is calculated automatically from pCO2</p></td>
    </tr>
    <tr>
      <th>solubility</th>
      <td><p>the solubility of CO2, by default is determined based on the temperature of the system</p></td>
    </tr>
    <tr>
      <th>temperature</th>
      <td><p>the temperature of the system, used to calculate the solubility constant</p></td>
    </tr>
    <tr>
      <th>pKa1</th>
      <td><p>the acid dissociation constant for H2CO3*</p></td>
    </tr>
    <tr>
      <th>pKa2</th>
      <td><p>the acid dissociation constant for bicarbonate (HCO3-)</p></td>
    </tr>
    <tr>
      <th>pKw</th>
      <td><p>water dissociation constant</p></td>
    </tr>
    <tr>
      <th>buffer</th>
      <td><p>[optional] total concentration of the pH buffer (a molarity quantity). Assumes that this is a protonated weak acid with the provided <code>buffer_pKa</code>. For weak base buffers, provide a negative molarity quantity instead and the appropriate <code>buffer_pKa</code>. If the buffer is a salt (e.g. Na-Buffer or Buffer-Cl), make sure to add the appropriate molarity to the <code>alkalinity</code> to account for the added ions (positive for hard cations, negative for hard anions). By default no additional buffer is added.</p></td>
    </tr>
    <tr>
      <th>buffer_pKa</th>
      <td><p>buffer acid dissociation constant, required if <code>buffer</code> is provided</p></td>
    </tr>
    <tr>
      <th>alkalinity</th>
      <td><p>[optional] charge-weighed NET concentration of all conservative ions [units charge x a molarity quantity] (explicitly conservative alkalinity). Conservative ions are those that do NOT get affected by changes in pH in the pH range of interest (i.e. do not form any acids or bases or have pKas far outside the pH range of interest). E.g. mol/L Na that was added in the form of NaOH, NaHCO3 or as part of a Na-buffer salt; -1 x mol/L Cl that was added as HCl or -2 x mol/L SO4 that was added as H2SO4. Ions from salts that are comprised exclusively of conservative ions (e.g. NaCl, MgSO4) do not need to be included because they cancel out. By default the alkalinity of the system is 0 M.</p></td>
    </tr>
    <tr>
      <th>pH</th>
      <td><p>the pH of the system</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>calculate_open_system_pH</code>: calculate the pH of an open system. Returns pH.</p></li>
<li><p><code>calculate_open_system_alkalinity</code>: calculates the alkalinity of an open system that is carbonate buffered and has an optional additional weak acid/base buffer. Returns the alkalinity as a molarity quantity. positive = excess cations, negative = excess anions.</p></li>
</ul>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other carbonate chemistry: 
<code><a href='closed_system.html'>closed_system</a></code>,
<code><a href='speciation.html'>speciation</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>calculate_open_system_pH</span><span class='op'>(</span>pCO2 <span class='op'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='st'>"mbar"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 4.390743</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



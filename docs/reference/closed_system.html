<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Closed system calculations — closed_system • MediaChemTools</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Closed system calculations — closed_system" />

<meta property="og:description" content="Functions to calculate pH, alkalinity, total inorganic carbon and pCO2 in a closed, carbonate-buffered system at equilibrium (i.e. finite liquid and gas/headspace volume at equilibrium) with an optional additional weak acid/base buffer. This is for simplified aqueous geochemical systems commonly encountered in culturing applications. All default constants are based on freshwater and there is no implicit salinity correction included (stability constants can be set manually). For more complex systems, please use a full aquatic chemistry suite instead." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106138361-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-106138361-4');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MediaChemTools</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="in active development">0.3.2.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/quantities.html">Quantities</a>
</li>
<li>
  <a href="../articles/operations.html">Operations</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Carbonate Buffering
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/carbonate_chemistry_equations.html">Equations</a>
    </li>
    <li>
      <a href="../articles/carbonate_chemistry_examples.html">Examples</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kopflab/mediachemtools">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Closed system calculations</h1>
    <small class="dont-index">Source: <a href='https://github.com/kopflab/mediachemtools/blob/master/R/carbonate_chem.R'><code>R/carbonate_chem.R</code></a></small>
    <div class="hidden name"><code>closed_system.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Functions to calculate pH, alkalinity, total inorganic carbon and pCO2 in a closed, carbonate-buffered system at equilibrium (i.e. finite liquid and gas/headspace volume at equilibrium) with an optional additional weak acid/base buffer. This is for simplified aqueous geochemical systems commonly encountered in culturing applications. All default constants are based on freshwater and there is no implicit salinity correction included (stability constants can be set manually). For more complex systems, please use a full aquatic chemistry suite instead.</p>
    
    </div>

    <pre class="usage"><span class='fu'>calculate_closed_system_pH</span>(<span class='no'>TIC</span>, <span class='no'>V_liquid</span>, <span class='no'>V_gas</span>,
  <span class='kw'>solubility</span> <span class='kw'>=</span> <span class='fu'><a href='gas_calculations.html'>calculate_solubility</a></span>(<span class='st'>"CO2"</span>, <span class='no'>temperature</span>),
  <span class='kw'>temperature</span> <span class='kw'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span>(<span class='fl'>25</span>, <span class='st'>"C"</span>), <span class='kw'>pKa1</span> <span class='kw'>=</span> <span class='fl'>6.3</span>, <span class='kw'>pKa2</span> <span class='kw'>=</span> <span class='fl'>10.3</span>, <span class='kw'>pKw</span> <span class='kw'>=</span> <span class='fl'>14</span>,
  <span class='kw'>buffer</span> <span class='kw'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span>(<span class='fl'>0</span>, <span class='st'>"M"</span>), <span class='no'>buffer_pKa</span>, <span class='kw'>alkalinity</span> <span class='kw'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span>(<span class='fl'>0</span>, <span class='st'>"M"</span>))

<span class='fu'>calculate_closed_system_alkalinity</span>(<span class='no'>pH</span>, <span class='no'>TIC</span>, <span class='no'>V_liquid</span>, <span class='no'>V_gas</span>,
  <span class='kw'>solubility</span> <span class='kw'>=</span> <span class='fu'><a href='gas_calculations.html'>calculate_solubility</a></span>(<span class='st'>"CO2"</span>, <span class='no'>temperature</span>),
  <span class='kw'>temperature</span> <span class='kw'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span>(<span class='fl'>25</span>, <span class='st'>"C"</span>), <span class='kw'>pKa1</span> <span class='kw'>=</span> <span class='fl'>6.3</span>, <span class='kw'>pKa2</span> <span class='kw'>=</span> <span class='fl'>10.3</span>, <span class='kw'>pKw</span> <span class='kw'>=</span> <span class='fl'>14</span>,
  <span class='kw'>buffer</span> <span class='kw'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span>(<span class='fl'>0</span>, <span class='st'>"M"</span>), <span class='no'>buffer_pKa</span>)

<span class='fu'>calculate_closed_system_TIC</span>(<span class='no'>pH</span>, <span class='no'>pCO2</span>, <span class='no'>V_gas</span>, <span class='no'>V_liquid</span>,
  <span class='kw'>temperature</span> <span class='kw'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span>(<span class='fl'>25</span>, <span class='st'>"C"</span>))

<span class='fu'>calculate_closed_system_pCO2</span>(<span class='no'>pH</span>, <span class='no'>TIC</span>, <span class='no'>V_gas</span>, <span class='no'>V_liquid</span>,
  <span class='kw'>solubility</span> <span class='kw'>=</span> <span class='fu'><a href='gas_calculations.html'>calculate_solubility</a></span>(<span class='st'>"CO2"</span>, <span class='no'>temperature</span>),
  <span class='kw'>temperature</span> <span class='kw'>=</span> <span class='fu'><a href='quantities.html'>qty</a></span>(<span class='fl'>25</span>, <span class='st'>"C"</span>), <span class='kw'>pKa1</span> <span class='kw'>=</span> <span class='fl'>6.3</span>, <span class='kw'>pKa2</span> <span class='kw'>=</span> <span class='fl'>10.3</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>TIC</th>
      <td><p>total inorganic carbon in the system (an amount quantity)</p></td>
    </tr>
    <tr>
      <th>V_liquid</th>
      <td><p>volume of liquid (a volume quantity)</p></td>
    </tr>
    <tr>
      <th>V_gas</th>
      <td><p>volume of the gas/headsapce (a volume quantity)</p></td>
    </tr>
    <tr>
      <th>solubility</th>
      <td><p>the solubility of CO2, by default is determined based on the temperature of the system</p></td>
    </tr>
    <tr>
      <th>temperature</th>
      <td><p>the temperature of the system, used to calculate the solubility constant</p></td>
    </tr>
    <tr>
      <th>pKa1</th>
      <td><p>the acid dissociation constant for H2CO3*</p></td>
    </tr>
    <tr>
      <th>pKa2</th>
      <td><p>the acid dissociation constant for bicarbonate (HCO3-)</p></td>
    </tr>
    <tr>
      <th>pKw</th>
      <td><p>water dissociation constant</p></td>
    </tr>
    <tr>
      <th>buffer</th>
      <td><p>[optional] total concentration of the pH buffer (a molarity quantity). Assumes that this is a protonated weak acid with the provided <code>buffer_pKa</code>. For weak base buffers, provide a negative molarity quantity instead and the appropriate <code>buffer_pKa</code>. If the buffer is a salt (e.g. Na-Buffer or Buffer-Cl), make sure to add the appropriate molarity to the <code>alkalinity</code> to account for the added ions (positive for hard cations, negative for hard anions). By default no additional buffer is added.</p></td>
    </tr>
    <tr>
      <th>buffer_pKa</th>
      <td><p>buffer acid dissociation constant, required if <code>buffer</code> is provided</p></td>
    </tr>
    <tr>
      <th>alkalinity</th>
      <td><p>[optional] charge-weighed NET concentration of all conservative ions [units charge x a molarity quantity] (explicitly conservative alkalinity). Conservative ions are those that do NOT get affected by changes in pH in the pH range of interest (i.e. do not form any acids or bases or have pKas far outside the pH range of interest). E.g. mol/L Na that was added in the form of NaOH, NaHCO3 or as part of a Na-buffer salt; -1 x mol/L Cl that was added as HCl or -2 x mol/L SO4 that was added as H2SO4. Ions from salts that are comprised exclusively of conservative ions (e.g. NaCl, MgSO4) do not need to be included because they cancel out. By default the alkalinity of the system is 0 M.</p></td>
    </tr>
    <tr>
      <th>pH</th>
      <td><p>the pH of the system</p></td>
    </tr>
    <tr>
      <th>pCO2</th>
      <td><p>the partial pressure of CO2 (a pressure quantity)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    <ul>
<li><p><code>calculate_closed_system_pH</code>: calculate the pH of a closed system. Returns pH.</p></li>
<li><p><code>calculate_closed_system_alkalinity</code>: calculates the alkalinity of a closed system that is carbonate buffered and has an optional additional weak acid/base buffer. Returns the alkalinity as a molarity quantity. positive = excess cations, negative = excess anions.</p></li>
<li><p><code>calculate_closed_system_TIC</code>: calculates total inorganic carbon (TIC) in a closed system at equilibrium. Returns TIC as an amount quantity.</p></li>
<li><p><code>calculate_closed_system_pCO2</code>: calculates the partial pressure of CO2 in the headspace (gas phase) of a closed system at equilibrium. Returns a pressure quantity.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other carbonate chemistry: <code><a href='open_system.html'>open_system</a></code>,
  <code><a href='speciation.html'>speciation</a></code></p></div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#functions">Functions</a></li>

      <li><a href="#see-also">See also</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

